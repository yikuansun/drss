!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).DRSS=e()}(this,(function(){"use strict";function t(t=""){let e="";for(let s=0;s<t.length;s++){let i=t.charAt(s);i.toLowerCase()!==i&&(e+="-"),e+=i.toLowerCase()}return e}class e{constructor(t){this.hook=(t,e,s)=>({}),this.hook=t}}class s{constructor(t){this.elements=[],this.ruleSets=[],this.query="",this.query=t}ruleset(t){let s;s="object"==typeof t?()=>t:t;const i=new e(s);return this.ruleSets.push(i),n._initialized&&this.render(n._props),this}render(e){var s;const i=document.querySelectorAll(this.query);for(let r=0;r<i.length;r++){const o=i[r],d={};for(const s of this.ruleSets){const i=s.hook(o,r,e);for(const e in i)d[t(e)]=i[e]}const l=n._getStyleElement(),c=null!==(s=o.dataset.drssid)&&void 0!==s?s:n.getNextId().toString();let a=`[data-drssid="${c}"]{`;for(const t in d)a+=t+":"+d[t]+";";a+="}",l.innerHTML+=a,o.dataset.drssid=c}}}class i extends s{constructor(t,e){super(t),this.states=[],this.states="string"==typeof e?[e]:e}render(e){var s;const i=document.querySelectorAll(this.query);for(let r=0;r<i.length;r++){const o=i[r],d={};for(const s of this.ruleSets){const i=s.hook(o,r,e);for(const e in i)d[t(e)]=i[e]}const l=n._getStyleElement(),c=null!==(s=o.dataset.drssid)&&void 0!==s?s:n.getNextId().toString();let a="";for(const t of this.states)a+=`[data-drssid="${c}"]:${t},`;a=a.substring(0,a.lastIndexOf(",")),a+="{";for(const t in d)a+=t+":"+d[t]+";";if(a+="}",this.states.includes("printing")){let t=`@media print{[data-drssid="${c}"]{`;for(let e in d)t+=e+":"+d[e]+";";t+="}}",a+=t}l.innerHTML+=a,o.dataset.drssid=c}}}class n{static update(){if(!this._initialized)return;this._getStyleElement().innerHTML="";for(const t of this.selectors)t.render(this._props)}static select(t,e=void 0){const n=e?new i(t,e):new s(t);return this.selectors.push(n),n}static getProps(){return this._props}static setProps(t){for(const e in t)this._props[e]=t[e];this.update()}static initialize(){if(!this._initialized){this._initialized=!0,this.update();new MutationObserver((()=>{n.update()})).observe(document.body,{childList:!0,subtree:!0}),window.addEventListener("resize",(()=>{n.update()}))}}static _getStyleElement(){let t=document.querySelector("style#drssHead");return t||(t=document.createElement("style"),t.id="drssHead",document.head.appendChild(t)),t}static getNextId(){return this._nextId++,this._nextId-1}}return n.selectors=[],n._props={},n._initialized=!1,n._nextId=0,n}));
